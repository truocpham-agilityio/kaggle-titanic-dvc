schema: '2.0'
stages:
  make_dataset:
    cmd: python3 src/data/make_dataset.py -c titanic -tr train.csv -te test.csv -o
      ./data/raw
    deps:
    - path: src/data/make_dataset.py
      md5: 4f66b01ce7fbc7219ddd5479027b4fce
      size: 1966
    params:
      params.yaml:
        dtypes:
          Age: float
          Embarked: category
          Fare: float
          Parch: int
          Pclass: category
          Sex: category
          SibSp: int
          Survived: category
    outs:
    - path: data/raw/test.csv
      md5: 029c9cd22461f6dbe8d9ab01def965c6
      size: 28629
    - path: data/raw/train.csv
      md5: 61fdd54abdbf6a85b778e937122e1194
      size: 61194
    - path: reports/figures/data_dictionary.tex
      md5: 10c5361db59b330722bd70b83ce0fcee
      size: 1521
    - path: reports/figures/table_one.tex
      md5: 4581508bdb37e12d9b9b5ff03244390d
      size: 844
  encode_labels:
    cmd: python3 src/data/encode_labels.py -tr data/raw/train.csv -te data/raw/test.csv
      -o data/interim
    deps:
    - path: data/raw/test.csv
      md5: 029c9cd22461f6dbe8d9ab01def965c6
      size: 28629
    - path: data/raw/train.csv
      md5: 61fdd54abdbf6a85b778e937122e1194
      size: 61194
    - path: src/data/encode_labels.py
      md5: 71c20e2dd8094132c4ca78915c4af31c
      size: 3311
    params:
      params.yaml:
        dtypes:
          Age: float
          Embarked: category
          Fare: float
          Parch: int
          Pclass: category
          Sex: category
          SibSp: int
          Survived: category
    outs:
    - path: data/interim/test_categorized.csv
      md5: f0fcdcd7bb08c23d382a665ac1436034
      size: 10788
    - path: data/interim/train_categorized.csv
      md5: 5d06666c95fed743140b44190fb67c77
      size: 23884
  impute_nan:
    cmd: python3 src/data/replace_nan.py -tr data/interim/train_categorized.csv -te
      data/interim/test_categorized.csv -o data/interim
    deps:
    - path: data/interim/test_categorized.csv
      md5: f0fcdcd7bb08c23d382a665ac1436034
      size: 10788
    - path: data/interim/train_categorized.csv
      md5: 5d06666c95fed743140b44190fb67c77
      size: 23884
    - path: src/data/replace_nan.py
      md5: a292443ade2893463ea8e78a2b2cb7fe
      size: 3527
    params:
      params.yaml:
        imputation:
          Age: 29.6991
          Fare: 32.2042
          method: mean
    outs:
    - path: data/interim/test_nan_imputed.csv
      md5: cbc38434c407b0761da80a422ba97cff
      size: 11136
    - path: data/interim/train_nan_imputed.csv
      md5: 9edd0421f46d2f0786ea6d82fdcf4e12
      size: 24592
  build_features:
    cmd: python3 src/features/build_features.py -tr data/interim/train_nan_imputed.csv
      -te data/interim/test_nan_imputed.csv -o data/interim/
    deps:
    - path: data/interim/test_nan_imputed.csv
      md5: cbc38434c407b0761da80a422ba97cff
      size: 11136
    - path: data/interim/train_nan_imputed.csv
      md5: 9edd0421f46d2f0786ea6d82fdcf4e12
      size: 24592
    - path: src/features/build_features.py
      md5: 15a0db18893a1dea5b5c425bbc04e2fb
      size: 4716
    params:
      params.yaml:
        feature_eng:
          featurize: true
        random_seed: 12345
    outs:
    - path: data/interim/test_featurized.csv
      md5: 6879b369c8d9f93c8ddeff61baea9ada
      size: 59474
    - path: data/interim/train_featurized.csv
      md5: 980d370c7991c5b991bf8c47d13beb02
      size: 127169
  normalize_data:
    cmd: python3 src/features/normalize.py -tr data/interim/train_featurized.csv -te
      data/interim/test_featurized.csv -o data/processed/
    deps:
    - path: data/interim/test_featurized.csv
      md5: 6879b369c8d9f93c8ddeff61baea9ada
      size: 59474
    - path: data/interim/train_featurized.csv
      md5: 980d370c7991c5b991bf8c47d13beb02
      size: 127169
    - path: src/features/normalize.py
      md5: 06e7d4f840c84d24a8892496db8f3e19
      size: 1610
    params:
      params.yaml:
        normalize:
    outs:
    - path: data/processed/test_processed.csv
      md5: 0cb34fc53024fa12b32a098a32870612
      size: 59004
    - path: data/processed/train_processed.csv
      md5: 55fc818f9babfe04c7bd9a605e0f6240
      size: 126326
  split_train_dev:
    cmd: python3 src/data/split_train_dev.py -tr data/processed/train_processed.csv
      -o data/processed/
    deps:
    - path: data/processed/train_processed.csv
      md5: 55fc818f9babfe04c7bd9a605e0f6240
      size: 126326
    - path: src/data/split_train_dev.py
      md5: 3ccd2f141aa14c9a0ea84e4fa6f461ca
      size: 2652
    params:
      params.yaml:
        random_seed: 12345
        train_test_split:
          n_split: 10
          shuffle: true
          target_class: Survived
    outs:
    - path: data/processed/split_train_dev.csv
      md5: d4d2c3159380a986fc2f04a8bcffda08
      size: 56115
  train_model:
    cmd: python3 src/models/train_model.py -tr data/processed/train_processed.csv
      -cv data/processed/split_train_dev.csv
    deps:
    - path: data/processed/split_train_dev.csv
      md5: d4d2c3159380a986fc2f04a8bcffda08
      size: 56115
    - path: data/processed/train_processed.csv
      md5: 55fc818f9babfe04c7bd9a605e0f6240
      size: 126326
    - path: src/models/train_model.py
      md5: 3edee7d3e727ce6d3587557a3924eca3
      size: 4110
    params:
      params.yaml:
        classifier: random_forest
        model_params:
          logistic_regression:
          naive_bayes:
          neural_network:
          random_forest:
            criterion: gini
            max_depth: 15
            max_features: auto
            min_samples_leaf: 6
            min_samples_split: 9
            n_estimators: 460
          support_vector_machine:
          xgboost:
        random_seed: 12345
        train_test_split.target_class: Survived
    outs:
    - path: models/estimator.pkl
      md5: a97b560743390021fc662ba0496e6237
      size: 31660351
    - path: results/metrics.json
      md5: 9906a600b727281c8328e39c508bf68e
      size: 318
  predict_output:
    cmd: python3 src/models/predict.py -te data/processed/test_processed.csv -rd results/
      -md models/
    deps:
    - path: data/processed/test_processed.csv
      md5: 0cb34fc53024fa12b32a098a32870612
      size: 59004
    - path: models/estimator.pkl
      md5: a97b560743390021fc662ba0496e6237
      size: 31660351
    - path: src/models/metrics.py
      md5: 71807a31d25c031180a695981df6fe9c
      size: 1742
    - path: src/models/predict.py
      md5: ffcea00661810b8f82c86a6c39309253
      size: 2954
    params:
      params.yaml:
        predict:
          js_estimator: true
        train_test_split.target_class: Survived
    outs:
    - path: results/test_predict_binary.csv
      md5: 76577b506c3bc22a50d1aa61f3b940d0
      size: 2839
    - path: results/test_predict_proba.csv
      md5: 84ac915213a1b4f510486a0d049f39df
      size: 10087
